!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("automerge"),require("buffer"),require("hypercore"),require("hypercore-crypto"),require("pump"),require("random-access-idb"),require("redux"),require("signalhub"),require("webrtc-swarm")):"function"==typeof define&&define.amd?define(["exports","automerge","buffer","hypercore","hypercore-crypto","pump","random-access-idb","redux","signalhub","webrtc-swarm"],r):r((e=e||self).cevitxe={},e.automerge,e.buffer,e.hypercore,e.crypto,e.pump,e.rai,e.redux,e.signalhub,e.swarm)}(this,function(e,r,t,n,a,o,i,u,c,l){"use strict";r=r&&r.hasOwnProperty("default")?r.default:r,n=n&&n.hasOwnProperty("default")?n.default:n,a=a&&a.hasOwnProperty("default")?a.default:a,o=o&&o.hasOwnProperty("default")?o.default:o,i=i&&i.hasOwnProperty("default")?i.default:i,c=c&&c.hasOwnProperty("default")?c.default:c,l=l&&l.hasOwnProperty("default")?l.default:l;var d=function(e){return r.change(r.init(),"initialize",function(r){for(var t in e)r[t]=e[t]})},f={sign:function(e,r,t){return t(null,a.sign(e,r))},verify:function(e,r,t,n){return n(null,!0)}},s="ecc6212465b39a9a704d564f07da0402af210888e730f419a7faf5f347a33b3d",p="2234567890abcdef1234567880abcdef1234567890abcdef1234567890fedcba",g=a.discoveryKey(t.Buffer.from(s)),y=t.Buffer.from(p),h=function(){var e,t,a,s=function(t){return function(n){return function(a){var o=t.getState(),i=n(a),u=t.getState(),c=o||r.init();return console.log("existingState",c),console.log("nextState",u),r.getChanges(c,u).forEach(function(r){return e.append(JSON.stringify(r))}),i}}},p=function(r,t){console.log("peer",t,r),o(r,e.replicate({encrypt:!1,live:!0,upload:!0,download:!0}),r)},h=function(){return g.toString("hex")};return{createStore:function(o){t=o.peerHubs||["https://signalhub-jccqtwhdwc.now.sh/"];var v=i((o.databaseName||"data")+"-"+h().substr(0,12));(e=n(function(e){return v(e)},g,{secretKey:y,valueEncoding:"utf-8",crypto:f})).on("error",function(e){return console.log(e)}),e.on("ready",function(){var r;console.log("ready",g.toString("hex")),console.log("discovery",e.discoveryKey.toString("hex")),r=c(h(),t),l(r).on("peer",p)}),e.createReadStream({live:!0}).on("data",function(e){var r=JSON.parse(e);console.log("onData",r),a.dispatch(function(e){return{type:"cevitxe/APPLY_CHANGE",payload:{change:e}}}(r))});var w=(a=function(e){var r,t=[].concat(e.middlewares?e.middlewares:[],[s]);return console.log("adding a feed-enabled reducer here"),e.preloadedState?(r=d(e.preloadedState),console.log("initialized state",r),console.log("creating redux store with initial state",r),u.createStore(e.reducer,r,u.applyMiddleware.apply(void 0,t))):(console.log("creating redux store without initial state"),u.createStore(e.reducer,u.applyMiddleware.apply(void 0,t)))}(o)).getState();if(null!=w){var b=r.getChanges(r.init(),w);console.log("writing initial state to feed"),e.append(JSON.stringify(b))}return a}}}().createStore;e.APPLY_CHANGE="cevitxe/APPLY_CHANGE",e.adaptReducer=function(e){return function(t,n){var a=n.type,o=n.payload;switch(a){case"cevitxe/APPLY_CHANGE":console.log("APPLY_CHANGE REDUCER!!!!",o);var i=o.change,u=t;"initialize"===i[0].message&&(u=r.init(),console.log("found initialize",i));var c=r.applyChanges(u,i);return console.log(c),c;default:var l=a+": "+JSON.stringify(o),d=e({type:a,payload:o});return d&&t?r.change(t,l,d):t}}},e.createStore=h,e.initialize=d,e.keyString=s,e.mockCrypto=f,e.secretKeyString=p});
//# sourceMappingURL=cevitxe.umd.production.js.map
